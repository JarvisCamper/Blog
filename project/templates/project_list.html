{% extends "layout.html" %}
{% load static %}

{% block title %}
My Blog Project
{% endblock %}

{% block content %}
<h1 class="text-center mt-4">Welcome to My Blog Project</h1>

<a href="{% url 'project_create' %}" class="btn btn-primary mb-3">Create New Project</a>

<div class="container row gap-3">
  {% if projects %}
    {% for project in projects %}
    <!-- ðŸ”¹ Entire card is clickable -->
    <div class="card bg-dark text-light border-secondary shadow project-card"
         style="width: 18rem; cursor: pointer;"
         data-bs-toggle="modal" data-bs-target="#projectModal{{ project.id }}">
      <div class="card-body">
        <h5 class="card-title">{{ project.user.username }}</h5>
        <p class="card-text">{{ project.text|truncatechars:100 }}</p>

        {% if project.user == user %}
          <div class="mt-2">
            <a href="{% url 'project_edit' project.id %}" class="btn btn-primary btn-sm" onclick="event.stopPropagation()">Edit</a>
            <a href="{% url 'project_delete' project.id %}" class="btn btn-danger btn-sm" onclick="event.stopPropagation()">Delete</a>
          </div>
        {% endif %}
      </div>
    </div>

    <!-- ðŸ”¹ Modal shows photo + full blog -->
    <div class="modal fade" id="projectModal{{ project.id }}" tabindex="-1" aria-labelledby="projectModalLabel{{ project.id }}" aria-hidden="true">
      <div class="modal-dialog modal-lg modal-dialog-centered">
        <div class="modal-content bg-dark text-light">
          <div class="modal-header">
            <h5 class="modal-title" id="projectModalLabel{{ project.id }}">Post by {{ project.user.username }}</h5>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
          </div>
          <div class="modal-body">
            {% if project.photo %}
              <img src="{{ project.photo.url }}" class="img-fluid rounded mb-3" alt="Blog image">
            {% endif %}
            <p>{{ project.text }}</p>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          </div>
        </div>
      </div>
    </div>
    {% endfor %}
  {% else %}
    <div class="alert alert-warning text-center" role="alert">
      No projects found{% if query %} for "<strong>{{ query }}</strong>"{% endif %}.
    </div>
  {% endif %}
</div>


<style>
.project-card:hover {
  background-color: #222 !important;
  transform: scale(1.02);
  transition: all 0.2s ease-in-out;
}
</style>
{% endblock %}
